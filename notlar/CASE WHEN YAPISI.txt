//faturalar Turu A ise Açýk K ise Kapalý fatura þeklinde yaptýk.

SELECT        dbo.TBLFATURALAR.ID, dbo.TBLFATURALAR.FATURANO, dbo.TBLFATURALAR.CARIKODU, dbo.TBLFATURALAR.TARIH, dbo.TBLFATURALAR.GENELTOPLAM, dbo.TBLFATURALAR.TURU, dbo.TBLFATURALAR.TIPI, 
                         dbo.TBLFATURALAR.VADETARIHI,

(CASE WHEN dbo.TBLFATURALAR.TURU='A' THEN 'AÇIK' ELSE 'KAPALI' END) AS TURUADI
FROM            dbo.TBLCARILER INNER JOIN
                         dbo.TBLFATURALAR ON dbo.TBLCARILER.CARIKODU = dbo.TBLFATURALAR.CARIKODU



///VWBANKAHAR

SELECT        dbo.TBLBANKAHAR.ID AS HAREKETID, dbo.TBLBANKAHAR.BANKAID, dbo.TBLBANKAHAR.FISNO, dbo.TBLBANKAHAR.MAKBUZNO, dbo.TBLBANKAHAR.TARIH, dbo.TBLBANKAHAR.GCKODU, 
                         dbo.TBLBANKAHAR.TIPI, dbo.TBLBANKAHAR.TUTAR, dbo.TBLBANKAHAR.CARIKODU, dbo.TBLBANKAHAR.ACIKLAMA, dbo.TBLBANKA.HESAPNO, dbo.TBLBANKA.IBAN, dbo.TBLBANKA.BANKAADI, 
                         dbo.TBLBANKA.HESAPADI, dbo.TBLCARILER.CARIISIM, (CASE WHEN GCKODU = 'G' THEN TUTAR ELSE 0 END) AS GIRIS, (CASE WHEN GCKODU = 'C' THEN TUTAR ELSE 0 END) AS CIKIS
FROM            dbo.TBLCARILER RIGHT OUTER JOIN
                         dbo.TBLBANKAHAR ON dbo.TBLCARILER.CARIKODU = dbo.TBLBANKAHAR.CARIKODU LEFT OUTER JOIN
                         dbo.TBLBANKA ON dbo.TBLBANKAHAR.BANKAID = dbo.TBLBANKA.ID




///VWKASABAKIYE (CASE WHEN OLAYI)
SELECT        dbo.TBLKASA.KODU AS KASAKODU, SUM(CASE WHEN GCKODU = 'G' THEN TUTAR ELSE 0 END) AS GIRIS, SUM(CASE WHEN GCKODU = 'C' THEN TUTAR ELSE 0 END) AS CIKIS, 
                         SUM((CASE WHEN GCKODU = 'G' THEN TUTAR ELSE 0 END) - (CASE WHEN GCKODU = 'C' THEN TUTAR ELSE 0 END)) AS BAKIYE
FROM            dbo.TBLKASAHAR RIGHT OUTER JOIN
                         dbo.TBLKASA ON dbo.TBLKASAHAR.KASAKODU = dbo.TBLKASA.KODU
GROUP BY dbo.TBLKASA.KODU
