//DIZFATURALAR
SELECT        dbo.TBLCARILER.CARIKODU, dbo.TBLCARILER.CARIISIM, dbo.TBLCARILER.ADRES, dbo.TBLCARILER.IL, dbo.TBLCARILER.ILCE, dbo.TBLCARILER.TELEFON, dbo.TBLCARILER.FAX, dbo.TBLCARILER.WEB, 
                         dbo.TBLCARILER.EMAIL, dbo.TBLCARILER.VERGIDAIRESI, dbo.TBLCARILER.VERGINUMARASI, dbo.TBLFATURALAR.FATURANO, dbo.TBLFATURALAR.TARIH, dbo.TBLFATURALAR.VADETARIHI, 
                         dbo.TBLFATURALAR.TURU, dbo.TBLFATURALAR.TIPI, dbo.TBLFATURALAR.ACIKLAMA, dbo.VWSTOKHAR.STOKKODU, dbo.VWSTOKHAR.STOKADI, dbo.VWSTOKHAR.BIRIM, dbo.VWSTOKHAR.BARKOD, 
                         dbo.VWSTOKHAR.SATISFIYAT1, dbo.VWSTOKHAR.GCKOD, dbo.VWSTOKHAR.MIKTAR, dbo.VWSTOKHAR.BRUTFIYAT, dbo.VWSTOKHAR.ISK1, dbo.VWSTOKHAR.ISK2, dbo.VWSTOKHAR.KDV, 
                         dbo.VWSTOKHAR.BIRIMFIYAT, dbo.VWSTOKHAR.TOPLAM, dbo.VWSTOKHAR.BRUTFIYAT - dbo.VWSTOKHAR.BIRIMFIYAT AS ISKONTO, dbo.VWFATURATOPLAMLARI.TOPLAMBRUT, 
                         dbo.VWFATURATOPLAMLARI.TOPLAMISKONTO, dbo.VWFATURATOPLAMLARI.TOPLAMARA, dbo.VWFATURATOPLAMLARI.TOPLAMKDV, dbo.VWFATURATOPLAMLARI.TOPLAMGENEL
FROM            dbo.TBLCARILER INNER JOIN
                         dbo.TBLFATURALAR ON dbo.TBLCARILER.CARIKODU = dbo.TBLFATURALAR.CARIKODU INNER JOIN
                         dbo.VWSTOKHAR ON dbo.TBLFATURALAR.FATURANO = dbo.VWSTOKHAR.FATURANO INNER JOIN
                         dbo.VWFATURATOPLAMLARI ON dbo.TBLFATURALAR.FATURANO = dbo.VWFATURATOPLAMLARI.FATURANO



//VWFATURATOPLAMLARI
SELECT        FATURANO, SUM(BRUTFIYAT * MIKTAR) AS TOPLAMBRUT, SUM((BRUTFIYAT - BIRIMFIYAT) * MIKTAR) AS TOPLAMISKONTO, SUM(BIRIMFIYAT * MIKTAR) AS TOPLAMARA, SUM(BIRIMFIYAT / 100 * KDV * MIKTAR) 
                         AS TOPLAMKDV, SUM((BIRIMFIYAT + BIRIMFIYAT / 100 * KDV) * MIKTAR) AS TOPLAMGENEL
FROM            dbo.VWSTOKHAR
GROUP BY FATURANO